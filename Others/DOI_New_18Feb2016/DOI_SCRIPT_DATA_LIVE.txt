
import module namespace constants = "http://www.TheIET.org/constants"   at "/Utils/constants.xqy";
let $Videos := <records><record><no>1</no><doi>10.1049/iet-tv.48.48</doi></record><record><no>4</no><doi>10.1049/iet-tv.46.140</doi></record><record><no>7</no><doi>10.1049/iet-tv.46.53</doi></record><record><no>13</no><doi>10.1049/iet-tv.45.45</doi></record><record><no>27</no><doi>10.1049/iet-tv.48.50</doi></record><record><no>28</no><doi>10.1049/iet-tv.50.55</doi></record><record><no>31</no><doi>10.1049/iet-tv.46.61</doi></record><record><no>50</no><doi>10.1049/iet-tv.49.82</doi></record><record><no>66</no><doi>10.1049/iet-tv.46.125</doi></record><record><no>84</no><doi>10.1049/iet-tv.50.148</doi></record><record><no>97</no><doi>10.1049/iet-tv.44.162</doi></record><record><no>98</no><doi>10.1049/iet-tv.44.166</doi></record><record><no>99</no><doi>10.1049/iet-tv.50.173</doi></record><record><no>131</no><doi>10.1049/iet-tv.46.209</doi></record><record><no>137</no><doi>10.1049/iet-tv.45.213</doi></record><record><no>193</no><doi>10.1049/iet-tv.41.296</doi></record><record><no>257</no><doi>10.1049/iet-tv.48.441</doi></record><record><no>319</no><doi>10.1049/iet-tv.45.443</doi></record><record><no>326</no><doi>10.1049/iet-tv.50.454</doi></record><record><no>384</no><doi>10.1049/iet-tv.45.536</doi></record><record><no>499</no><doi>10.1049/iet-tv.41.566</doi></record><record><no>555</no><doi>10.1049/iet-tv.46.793</doi></record><record><no>579</no><doi>10.1049/iet-tv.44.947</doi></record><record><no>585</no><doi>10.1049/iet-tv.45.946</doi></record><record><no>586</no><doi>10.1049/iet-tv.50.820</doi></record><record><no>588</no><doi>10.1049/iet-tv.48.811</doi></record><record><no>624</no><doi>10.1049/iet-tv.45.949</doi></record><record><no>742</no><doi>10.1049/iet-tv.47.812</doi></record><record><no>900</no><doi>10.1049/iet-tv.41.833</doi></record><record><no>937</no><doi>10.1049/iet-tv.44.1174</doi></record><record><no>999</no><doi>10.1049/iet-tv.48.866</doi></record><record><no>1028</no><doi>10.1049/iet-tv.44.1343</doi></record><record><no>1069</no><doi>10.1049/iet-tv.47.826</doi></record><record><no>1085</no><doi>10.1049/iet-tv.50.908</doi></record><record><no>1456</no><doi>10.1049/iet-tv.44.1431</doi></record><record><no>1499</no><doi>10.1049/iet-tv.50.984</doi></record><record><no>1563</no><doi>10.1049/iet-tv.51.1168</doi></record><record><no>1771</no><doi>10.1049/iet-tv.47.895</doi></record><record><no>1816</no><doi>10.1049/iet-tv.51.1227</doi></record><record><no>2102</no><doi>10.1049/iet-tv.44.1703</doi></record><record><no>2169</no><doi>10.1049/iet-tv.49.892</doi></record><record><no>2170</no><doi>10.1049/iet-tv.47.936</doi></record><record><no>2171</no><doi>10.1049/iet-tv.51.1302</doi></record><record><no>2182</no><doi>10.1049/iet-tv.50.1209</doi></record><record><no>2197</no><doi>10.1049/iet-tv.46.1253</doi></record><record><no>2214</no><doi>10.1049/iet-tv.51.1305</doi></record><record><no>2217</no><doi>10.1049/iet-tv.44.1732</doi></record><record><no>2261</no><doi>10.1049/iet-tv.45.2309</doi></record><record><no>2367</no><doi>10.1049/iet-tv.48.1009</doi></record><record><no>2401</no><doi>10.1049/iet-tv.44.1800</doi></record><record><no>2402</no><doi>10.1049/iet-tv.42.1010</doi></record><record><no>2403</no><doi>10.1049/iet-tv.42.1012</doi></record><record><no>2404</no><doi>10.1049/iet-tv.42.1014</doi></record><record><no>2405</no><doi>10.1049/iet-tv.42.1011</doi></record><record><no>2406</no><doi>10.1049/iet-tv.42.1013</doi></record><record><no>2422</no><doi>10.1049/iet-tv.47.1006</doi></record><record><no>2432</no><doi>10.1049/iet-tv.45.7814</doi></record><record><no>2433</no><doi>10.1049/iet-tv.45.7818</doi></record><record><no>2434</no><doi>10.1049/iet-tv.45.7824</doi></record><record><no>2435</no><doi>10.1049/iet-tv.45.7826</doi></record><record><no>2436</no><doi>10.1049/iet-tv.45.7850</doi></record><record><no>2437</no><doi>10.1049/iet-tv.45.7852</doi></record><record><no>2438</no><doi>10.1049/iet-tv.45.7815</doi></record><record><no>2439</no><doi>10.1049/iet-tv.45.7819</doi></record><record><no>2441</no><doi>10.1049/iet-tv.45.7829</doi></record><record><no>2449</no><doi>10.1049/iet-tv.46.7862</doi></record><record><no>2494</no><doi>10.1049/iet-tv.51.8407</doi></record><record><no>2587</no><doi>10.1049/iet-tv.44.9555</doi></record><record><no>2609</no><doi>10.1049/iet-tv.45.7816</doi></record><record><no>2649</no><doi>10.1049/iet-tv.45.9840</doi></record><record><no>2731</no><doi>10.1049/iet-tv.47.10034</doi></record><record><no>2833</no><doi>10.1049/iet-tv.44.10340</doi></record><record><no>2857</no><doi>10.1049/iet-tv.44.10604</doi></record><record><no>2864</no><doi>10.1049/iet-tv.51.10761</doi></record><record><no>2909</no><doi>10.1049/iet-tv.49.11112</doi></record><record><no>3062</no><doi>10.1049/iet-tv.44.11786</doi></record><record><no>3289</no><doi>10.1049/iet-tv.50.12595</doi></record><record><no>3305</no><doi>10.1049/iet-tv.51.13229</doi></record><record><no>3315</no><doi>10.1049/iet-tv.47.12739</doi></record><record><no>3367</no><doi>10.1049/iet-tv.49.13011</doi></record><record><no>3371</no><doi>10.1049/iet-tv.46.13036</doi></record><record><no>3439</no><doi>10.1049/iet-tv.41.13322</doi></record><record><no>3512</no><doi>10.1049/iet-tv.42.13504</doi></record><record><no>3513</no><doi>10.1049/iet-tv.42.13503</doi></record><record><no>3514</no><doi>10.1049/iet-tv.42.13505</doi></record><record><no>3516</no><doi>10.1049/iet-tv.42.13513</doi></record><record><no>3653</no><doi>10.1049/iet-tv.44.13958</doi></record><record><no>4174</no><doi>10.1049/iet-tv.47.16065</doi></record><record><no>4251</no><doi>10.1049/iet-tv.41.16302</doi></record><record><no>4279</no><doi>10.1049/iet-tv.47.15896</doi></record><record><no>4370</no><doi>10.1049/iet-tv.42.16895</doi></record><record><no>4371</no><doi>10.1049/iet-tv.42.16897</doi></record><record><no>4372</no><doi>10.1049/iet-tv.42.16894</doi></record><record><no>4374</no><doi>10.1049/iet-tv.42.16898</doi></record><record><no>4462</no><doi>10.1049/iet-tv.44.17139</doi></record><record><no>4536</no><doi>10.1049/iet-tv.41.17534</doi></record><record><no>4545</no><doi>10.1049/iet-tv.41.17630</doi></record><record><no>4827</no><doi>10.1049/iet-tv.44.18271</doi></record><record><no>4866</no><doi>10.1049/iet-tv.41.18342</doi></record><record><no>4867</no><doi>10.1049/iet-tv.41.18344</doi></record><record><no>4868</no><doi>10.1049/iet-tv.41.18346</doi></record><record><no>4870</no><doi>10.1049/iet-tv.41.18341</doi></record><record><no>4871</no><doi>10.1049/iet-tv.41.18343</doi></record><record><no>4872</no><doi>10.1049/iet-tv.41.18345</doi></record><record><no>4873</no><doi>10.1049/iet-tv.41.18347</doi></record><record><no>5012</no><doi>10.1049/iet-tv.41.18571</doi></record><record><no>5027</no><doi>10.1049/iet-tv.41.18825</doi></record><record><no>5028</no><doi>10.1049/iet-tv.44.18890</doi></record><record><no>5029</no><doi>10.1049/iet-tv.44.19259</doi></record><record><no>5030</no><doi>10.1049/iet-tv.44.19263</doi></record><record><no>5033</no><doi>10.1049/iet-tv.45.19411</doi></record><record><no>5036</no><doi>10.1049/iet-tv.45.19427</doi></record><record><no>5037</no><doi>10.1049/iet-tv.44.19254</doi></record><record><no>5038</no><doi>10.1049/iet-tv.44.19260</doi></record><record><no>5039</no><doi>10.1049/iet-tv.44.19264</doi></record><record><no>5041</no><doi>10.1049/iet-tv.41.18858</doi></record><record><no>5045</no><doi>10.1049/iet-tv.51.18951</doi></record><record><no>5047</no><doi>10.1049/iet-tv.51.18953</doi></record><record><no>5048</no><doi>10.1049/iet-tv.51.18955</doi></record><record><no>5049</no><doi>10.1049/iet-tv.51.18957</doi></record><record><no>5056</no><doi>10.1049/iet-tv.51.18952</doi></record><record><no>5057</no><doi>10.1049/iet-tv.51.18954</doi></record><record><no>5058</no><doi>10.1049/iet-tv.51.18956</doi></record><record><no>5091</no><doi>10.1049/iet-tv.51.19012</doi></record><record><no>5092</no><doi>10.1049/iet-tv.41.19518</doi></record><record><no>5093</no><doi>10.1049/iet-tv.41.18851</doi></record><record><no>5250</no><doi>10.1049/iet-tv.42.19340</doi></record><record><no>5251</no><doi>10.1049/iet-tv.42.19342</doi></record><record><no>5252</no><doi>10.1049/iet-tv.42.19344</doi></record><record><no>5254</no><doi>10.1049/iet-tv.42.19343</doi></record><record><no>5319</no><doi>10.1049/iet-tv.45.19249</doi></record><record><no>5444</no><doi>10.1049/iet-tv.50.19587</doi></record><record><no>5447</no><doi>10.1049/iet-tv.41.19509</doi></record><record><no>5473</no><doi>10.1049/iet-tv.49.19682</doi></record><record><no>5499</no><doi>10.1049/iet-tv.49.19726</doi></record><record><no>5501</no><doi>10.1049/iet-tv.41.19709</doi></record><record><no>5517</no><doi>10.1049/iet-tv.50.19777</doi></record><record><no>5551</no><doi>10.1049/iet-tv.41.19888</doi></record><record><no>5571</no><doi>10.1049/iet-tv.45.19982</doi></record><record><no>5708</no><doi>10.1049/iet-tv.51.20340</doi></record><record><no>5710</no><doi>10.1049/iet-tv.51.20404</doi></record><record><no>5779</no><doi>10.1049/iet-tv.41.40557</doi></record><record><no>5829</no><doi>10.1049/iet-tv.41.20324</doi></record><record><no>5867</no><doi>10.1049/iet-tv.51.40652</doi></record><record><no>5874</no><doi>10.1049/iet-tv.51.40839</doi></record><record><no>5879</no><doi>10.1049/iet-tv.51.40859</doi></record><record><no>5882</no><doi>10.1049/iet-tv.51.40867</doi></record><record><no>5884</no><doi>10.1049/iet-tv.51.40948</doi></record><record><no>5890</no><doi>10.1049/iet-tv.51.40864</doi></record><record><no>5893</no><doi>10.1049/iet-tv.51.40949</doi></record><record><no>5963</no><doi>10.1049/iet-tv.41.19815</doi></record><record><no>5986</no><doi>10.1049/iet-tv.44.40970</doi></record><record><no>5988</no><doi>10.1049/iet-tv.44.40968</doi></record><record><no>5989</no><doi>10.1049/iet-tv.44.40972</doi></record><record><no>5996</no><doi>10.1049/iet-tv.51.41039</doi></record><record><no>5997</no><doi>10.1049/iet-tv.51.41043</doi></record><record><no>5998</no><doi>10.1049/iet-tv.51.41047</doi></record><record><no>5999</no><doi>10.1049/iet-tv.51.41049</doi></record><record><no>6003</no><doi>10.1049/iet-tv.51.41036</doi></record><record><no>6004</no><doi>10.1049/iet-tv.51.41040</doi></record><record><no>6005</no><doi>10.1049/iet-tv.51.41038</doi></record><record><no>6006</no><doi>10.1049/iet-tv.51.41042</doi></record><record><no>6007</no><doi>10.1049/iet-tv.51.41044</doi></record><record><no>6008</no><doi>10.1049/iet-tv.51.41046</doi></record><record><no>6009</no><doi>10.1049/iet-tv.51.41050</doi></record><record><no>6010</no><doi>10.1049/iet-tv.51.41048</doi></record><record><no>6015</no><doi>10.1049/iet-tv.51.41037</doi></record><record><no>6016</no><doi>10.1049/iet-tv.51.41041</doi></record><record><no>6018</no><doi>10.1049/iet-tv.51.41055</doi></record><record><no>6020</no><doi>10.1049/iet-tv.51.41061</doi></record><record><no>6022</no><doi>10.1049/iet-tv.51.41052</doi></record><record><no>6023</no><doi>10.1049/iet-tv.51.41054</doi></record><record><no>6024</no><doi>10.1049/iet-tv.51.41058</doi></record><record><no>6031</no><doi>10.1049/iet-tv.44.41065</doi></record><record><no>6032</no><doi>10.1049/iet-tv.44.41067</doi></record><record><no>6033</no><doi>10.1049/iet-tv.44.41071</doi></record><record><no>6034</no><doi>10.1049/iet-tv.44.41069</doi></record><record><no>6039</no><doi>10.1049/iet-tv.44.41070</doi></record><record><no>6040</no><doi>10.1049/iet-tv.44.41068</doi></record><record><no>6041</no><doi>10.1049/iet-tv.44.41151</doi></record><record><no>6043</no><doi>10.1049/iet-tv.44.41153</doi></record><record><no>6045</no><doi>10.1049/iet-tv.44.41159</doi></record><record><no>6048</no><doi>10.1049/iet-tv.48.41203</doi></record><record><no>6050</no><doi>10.1049/iet-tv.44.41173</doi></record><record><no>6051</no><doi>10.1049/iet-tv.44.41175</doi></record><record><no>6052</no><doi>10.1049/iet-tv.44.41177</doi></record><record><no>6053</no><doi>10.1049/iet-tv.44.41181</doi></record><record><no>6054</no><doi>10.1049/iet-tv.44.41179</doi></record><record><no>6055</no><doi>10.1049/iet-tv.48.41183</doi></record><record><no>6059</no><doi>10.1049/iet-tv.44.41174</doi></record><record><no>6060</no><doi>10.1049/iet-tv.44.41176</doi></record><record><no>6061</no><doi>10.1049/iet-tv.44.41180</doi></record><record><no>6062</no><doi>10.1049/iet-tv.44.41178</doi></record><record><no>6063</no><doi>10.1049/iet-tv.48.41184</doi></record><record><no>6090</no><doi>10.1049/iet-tv.51.41306</doi></record><record><no>6099</no><doi>10.1049/iet-tv.41.40957</doi></record><record><no>6100</no><doi>10.1049/iet-tv.42.41240</doi></record><record><no>6101</no><doi>10.1049/iet-tv.42.41238</doi></record><record><no>6102</no><doi>10.1049/iet-tv.42.41242</doi></record><record><no>6103</no><doi>10.1049/iet-tv.42.41244</doi></record><record><no>6107</no><doi>10.1049/iet-tv.42.41237</doi></record><record><no>6108</no><doi>10.1049/iet-tv.42.41241</doi></record><record><no>6109</no><doi>10.1049/iet-tv.42.41239</doi></record><record><no>6110</no><doi>10.1049/iet-tv.42.41243</doi></record><record><no>6111</no><doi>10.1049/iet-tv.42.41245</doi></record><record><no>6112</no><doi>10.1049/iet-tv.42.41216</doi></record><record><no>6114</no><doi>10.1049/iet-tv.44.41294</doi></record><record><no>6115</no><doi>10.1049/iet-tv.44.41283</doi></record><record><no>6116</no><doi>10.1049/iet-tv.44.41285</doi></record><record><no>6117</no><doi>10.1049/iet-tv.44.41291</doi></record><record><no>6118</no><doi>10.1049/iet-tv.44.41289</doi></record><record><no>6119</no><doi>10.1049/iet-tv.44.41293</doi></record><record><no>6120</no><doi>10.1049/iet-tv.44.41284</doi></record><record><no>6121</no><doi>10.1049/iet-tv.44.41286</doi></record><record><no>6122</no><doi>10.1049/iet-tv.44.41288</doi></record><record><no>6133</no><doi>10.1049/iet-tv.49.41296</doi></record><record><no>6177</no><doi>10.1049/iet-tv.49.41317</doi></record><record><no>6183</no><doi>10.1049/iet-tv.49.41319</doi></record><record><no>6199</no><doi>10.1049/iet-tv.49.41295</doi></record><record><no>6204</no><doi>10.1049/iet-tv.49.41297</doi></record><record><no>6221</no><doi>10.1049/iet-tv.49.41310</doi></record><record><no>6243</no><doi>10.1049/iet-tv.49.41318</doi></record><record><no>6258</no><doi>10.1049/iet-tv.44.41533</doi></record><record><no>6266</no><doi>10.1049/iet-tv.44.41398</doi></record><record><no>6267</no><doi>10.1049/iet-tv.48.41405</doi></record><record><no>6268</no><doi>10.1049/iet-tv.48.41407</doi></record><record><no>6269</no><doi>10.1049/iet-tv.48.41411</doi></record><record><no>6270</no><doi>10.1049/iet-tv.48.41409</doi></record><record><no>6271</no><doi>10.1049/iet-tv.50.41556</doi></record><record><no>6272</no><doi>10.1049/iet-tv.50.41558</doi></record><record><no>6273</no><doi>10.1049/iet-tv.48.41395</doi></record><record><no>6274</no><doi>10.1049/iet-tv.51.41397</doi></record><record><no>6275</no><doi>10.1049/iet-tv.50.41400</doi></record><record><no>6276</no><doi>10.1049/iet-tv.50.41399</doi></record><record><no>6277</no><doi>10.1049/iet-tv.50.41402</doi></record><record><no>6278</no><doi>10.1049/iet-tv.48.41404</doi></record><record><no>6279</no><doi>10.1049/iet-tv.48.41406</doi></record><record><no>6280</no><doi>10.1049/iet-tv.48.41410</doi></record><record><no>6281</no><doi>10.1049/iet-tv.50.41588</doi></record><record><no>6282</no><doi>10.1049/iet-tv.48.41408</doi></record><record><no>6283</no><doi>10.1049/iet-tv.48.41412</doi></record><record><no>6284</no><doi>10.1049/iet-tv.50.41557</doi></record><record><no>6285</no><doi>10.1049/iet-tv.50.41559</doi></record><record><no>6286</no><doi>10.1049/iet-tv.50.41430</doi></record><record><no>6288</no><doi>10.1049/iet-tv.48.41396</doi></record><record><no>6290</no><doi>10.1049/iet-tv.48.41415</doi></record><record><no>6291</no><doi>10.1049/iet-tv.48.41417</doi></record><record><no>6292</no><doi>10.1049/iet-tv.48.41421</doi></record><record><no>6293</no><doi>10.1049/iet-tv.48.41419</doi></record><record><no>6295</no><doi>10.1049/iet-tv.48.41425</doi></record><record><no>6296</no><doi>10.1049/iet-tv.48.41427</doi></record><record><no>6297</no><doi>10.1049/iet-tv.48.41429</doi></record><record><no>6299</no><doi>10.1049/iet-tv.48.41414</doi></record><record><no>6300</no><doi>10.1049/iet-tv.48.41416</doi></record><record><no>6301</no><doi>10.1049/iet-tv.48.41420</doi></record><record><no>6302</no><doi>10.1049/iet-tv.48.41418</doi></record><record><no>6303</no><doi>10.1049/iet-tv.48.41422</doi></record><record><no>6304</no><doi>10.1049/iet-tv.48.41428</doi></record><record><no>6316</no><doi>10.1049/iet-tv.45.41505</doi></record><record><no>6320</no><doi>10.1049/iet-tv.45.41500</doi></record><record><no>6321</no><doi>10.1049/iet-tv.45.41499</doi></record><record><no>6322</no><doi>10.1049/iet-tv.45.41502</doi></record><record><no>6323</no><doi>10.1049/iet-tv.45.41504</doi></record><record><no>6326</no><doi>10.1049/iet-tv.45.41501</doi></record><record><no>6327</no><doi>10.1049/iet-tv.45.41503</doi></record><record><no>6707</no><doi>10.1049/iet-tv.41.16218</doi></record><record><no>6946</no><doi>10.1049/iet-tv.41.16743</doi></record><record><no>7044</no><doi>10.1049/iet-tv.47.16066</doi></record><record><no>7316</no><doi>10.1049/iet-tv.41.1568</doi></record><record><no>7318</no><doi>10.1049/iet-tv.41.17385</doi></record><record><no>7320</no><doi>10.1049/iet-tv.48.14987</doi></record><records>

for $eachVideo in $Videos/record
let $DOI:= $eachVideo/doi/text()
let $VNumber:= $eachVideo/no/text()
(:let $updatedDoi     := fn:concat($DOI,$VNumber):)
let $VideoID        := collection("Video")/Video[VideoNumber=$VNumber]/@ID/string()
let $VideoURI 			:= fn:concat($constants:VIDEO_DIRECTORY,$VideoID,".xml")
let $PHistoryUri		:= fn:concat($constants:PCOPY_DIRECTORY,$VideoID,".xml")
return
  (
    if(fn:doc-available($VideoURI))
    then
      let $doc := fn:doc($VideoURI)
      return
        if( $doc/Video/PublishInfo[VideoPublish/@active="yes"] )
        then xdmp:node-replace($doc/Video/PublishInfo/VideoPublish/DOI, <DOI>{$DOI}</DOI>)
        else
        if( $doc/Video/PublishInfo[LivePublish/@active="yes"] )
        then xdmp:node-replace($doc/Video/PublishInfo/LivePublish/DOI, <DOI>{$DOI}</DOI>)
        else xdmp:log(("======doi not replaced in =============", $VideoURI))
    else xdmp:log(("======document not available=============", $VideoURI))
    ,
    if(fn:doc-available($PHistoryUri))
    then
      let $doc := fn:doc($PHistoryUri)
      return
        if( $doc/Video/PublishInfo[VideoPublish/@active="yes"] )
        then xdmp:node-replace($doc/Video/PublishInfo/VideoPublish/DOI, <DOI>{$DOI}</DOI>)
        else
        if( $doc/Video/PublishInfo[LivePublish/@active="yes"] )
        then xdmp:node-replace($doc/Video/PublishInfo/LivePublish/DOI, <DOI>{$DOI}</DOI>)
        else xdmp:log(("======doi not replaced in =============", $PHistoryUri))
    else xdmp:log(("======document not available=============", $PHistoryUri))
   )    