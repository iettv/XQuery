xquery version "1.0-ml";

let $file := <Table><record><comment_id>5dbc41dc-5578-432f-a411-6c80622351cb</comment_id></record><record><comment_id>6dc101ae-f122-4cd9-8e85-59f21439a2e4</comment_id></record><record><comment_id>28ae295e-76f1-4ac4-84b1-886bf75726e3</comment_id></record><record><comment_id>fcde69ed-987a-4b0f-ab22-afa2483a7a7d</comment_id></record><record><comment_id>701d4001-42c1-462d-b7dd-46af92bb40a9</comment_id></record><record><comment_id>078aead0-27fe-4d6f-a9ba-dde318701638</comment_id></record><record><comment_id>7ef0e62c-b226-45bc-b27d-0da22d069cb7</comment_id></record><record><comment_id>7203bf3b-1d2c-4a50-ad8e-bfe0dce4e5b4</comment_id></record><record><comment_id>e88504a3-16b5-40f0-a9ba-5db53d1a7069</comment_id></record><record><comment_id>fcf9b943-e4b2-4a87-92f5-0f1087566fc7</comment_id></record><record><comment_id>8bc36ac6-8da1-4334-8da9-64f39be884a8</comment_id></record><record><comment_id>a75b7b7b-c46a-4b3e-a5d9-fb9d0a6d5caa</comment_id></record><record><comment_id>4a9ed6fd-e533-4252-9b29-4b6a11c65bc2</comment_id></record><record><comment_id>7ecfd042-026f-4e46-8fa7-8ca762668fab</comment_id></record><record><comment_id>3e7d9580-225b-41ec-8792-57470e7e34a2</comment_id></record><record><comment_id>0e9497a5-e3a1-4fd8-9662-1d46ba709e16</comment_id></record><record><comment_id>82770e1e-283f-44db-b869-5b712dea1c3e</comment_id></record><record><comment_id>d69617b7-e762-4401-82db-9b389e4cb55e</comment_id></record><record><comment_id>c4ddf6fb-dd46-42f8-876c-b977738b594c</comment_id></record><record><comment_id>f04b057d-efab-4c54-b90e-b09a8b48efe3</comment_id></record><record><comment_id>623d6256-58d8-4707-a4bc-aaf12825f121</comment_id></record><record><comment_id>2aa62a81-c47f-4d3f-8564-882da8349239</comment_id></record><record><comment_id>7b774376-b052-4b3d-a577-df0aec449db0</comment_id></record><record><comment_id>1eb8cce3-0544-4be4-8b86-a22e15a2d337</comment_id></record><record><comment_id>78285ebe-098c-4ea9-ac7f-be39a2d29452</comment_id></record><record><comment_id>be356106-d143-4c4f-b8a1-3bc547e9a666</comment_id></record><record><comment_id>f2dcdcf9-5d6e-4449-a4b7-c7e769b792c8</comment_id></record><record><comment_id>2eacd1ac-e858-4bdc-80fd-577cc0f6acb6</comment_id></record><record><comment_id>2afe6255-682e-431e-9775-95a4a526c988</comment_id></record><record><comment_id>773979d2-326f-4c96-9556-e10ecd7f6bde</comment_id></record><record><comment_id>93f911b1-2e92-4b5b-943d-4005dccec769</comment_id></record><record><comment_id>06ae3fba-2f52-4d9d-b14c-7919cc78a268</comment_id></record><record><comment_id>df747128-1719-43ee-b289-44e61582e09d</comment_id></record><record><comment_id>796814a3-7fc1-42f4-adc3-83e64706ff06</comment_id></record><record><comment_id>04ef03aa-76be-481c-aac5-2c4fee0a8052</comment_id></record><record><comment_id>9479aceb-862f-4d83-a938-dfad52a60f3a</comment_id></record><record><comment_id>cb7007e0-ff2a-458f-b4f4-528e121468d0</comment_id></record><record><comment_id>5b60329c-a904-4260-b797-cdeba21489c8</comment_id></record><record><comment_id>432a4a13-fe64-4d50-bb48-d8368dbbf622</comment_id></record><record><comment_id>dd08054b-6c02-46c6-a826-40633fa0c2ed</comment_id></record><record><comment_id>a374885d-8d4d-4a3c-8914-6bd246793efd</comment_id></record><record><comment_id>d3aba379-2157-464b-ab31-a7307ff69261</comment_id></record></Table>
    
for $rec in $file/record

let $cm_id := $rec/comment_id/text()

let $del_file := fn:collection()/Comment[matches(CommentID,$cm_id)]/base-uri()

return 
      if ($del_file!='')
      then (xdmp:document-delete($del_file), concat('XML file deleted successfully - ','uri: ',$del_file))
      else (concat('No Record found for this commentId = ',$cm_id))
